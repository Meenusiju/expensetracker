{"ast":null,"code":"import { select } from 'd3-selection';\nimport Kapsule from 'kapsule';\nimport tinycolor from 'tinycolor2';\nimport { fitToBox } from 'svg-text-fit';\nimport { gradient } from 'svg-utils';\nvar ContinuousLegend = Kapsule({\n  props: {\n    width: {},\n    height: {},\n    scale: {},\n    label: {}\n  },\n  init: function init(el, state) {\n    state.gradient = gradient()(el);\n    state.el = select(el); // Build dom\n\n    state.box = state.el.append('rect').attr('x', 0).attr('y', 0).attr('rx', 3).attr('ry', 3).attr('stroke', 'black').attr('stroke-width', 0.5);\n    state.unitLabel = state.el.append('text').attr('class', 'legendText').style('text-anchor', 'middle').style('dominant-baseline', 'central');\n    state.labelFitText = fitToBox()(state.unitLabel.node());\n    state.startLabel = state.el.append('text').style('text-anchor', 'start').style('dominant-baseline', 'central');\n    state.startLabelFitText = fitToBox()(state.startLabel.node());\n    state.endLabel = state.el.append('text').style('text-anchor', 'end').style('dominant-baseline', 'central');\n    state.endLabelFitText = fitToBox()(state.endLabel.node());\n  },\n  update: function update(state) {\n    state.gradient.colorScale(state.scale);\n    state.box.attr('width', state.width).attr('height', state.height).style('fill', \"url(#\".concat(state.gradient.id(), \")\"));\n    state.unitLabel.text(state.label).attr('x', state.width * 0.5).attr('y', state.height * 0.5).style('text-anchor', 'middle').style('dominant-baseline', 'central').style('fill', tinycolor(state.scale((state.scale.domain()[state.scale.domain().length - 1] - state.scale.domain()[0]) / 2)).isLight() ? '#444' : '#CCC');\n    state.labelFitText.bbox({\n      width: state.width * 0.8,\n      height: state.height * 0.9\n    });\n    state.startLabel.text(state.scale.domain()[0]).attr('x', state.width * 0.02).attr('y', state.height * 0.5).style('fill', tinycolor(state.scale(state.scale.domain()[0])).isLight() ? '#444' : '#CCC');\n    state.startLabelFitText.bbox({\n      width: state.width * 0.3,\n      height: state.height * 0.7\n    });\n    state.endLabel.text(state.scale.domain()[state.scale.domain().length - 1]).attr('x', state.width * 0.98).attr('y', state.height * 0.5).style('fill', tinycolor(state.scale(state.scale.domain()[state.scale.domain().length - 1])).isLight() ? '#444' : '#CCC');\n    state.endLabelFitText.bbox({\n      width: state.width * 0.3,\n      height: state.height * 0.7\n    });\n  }\n});\nvar DiscreteLegend = Kapsule({\n  props: {\n    width: {},\n    height: {},\n    scale: {},\n    label: {}\n  },\n  init: function init(el, state) {\n    state.el = select(el);\n  },\n  update: function update(state) {\n    var colorBinWidth = state.width / state.scale.domain().length;\n    var slot = state.el.selectAll('.color-slot').data(state.scale.domain());\n    slot.exit().remove();\n    var newSlot = slot.enter().append('g').attr('class', 'color-slot');\n    newSlot.append('rect').attr('y', 0).attr('rx', 0).attr('ry', 0).attr('stroke-width', 0);\n    newSlot.append('text').style('text-anchor', 'middle').style('dominant-baseline', 'central');\n    newSlot.append('title'); // Update\n\n    slot = slot.merge(newSlot);\n    slot.select('rect').attr('width', colorBinWidth).attr('height', state.height).attr('x', function (d, i) {\n      return colorBinWidth * i;\n    }).attr('fill', function (d) {\n      return state.scale(d);\n    });\n    slot.select('text').text(function (d) {\n      return d;\n    }).attr('x', function (d, i) {\n      return colorBinWidth * (i + .5);\n    }).attr('y', state.height * 0.5).style('fill', function (d) {\n      return tinycolor(state.scale(d)).isLight() ? '#333' : '#DDD';\n    }).each(function (d) {\n      fitToBox().bbox({\n        width: colorBinWidth * 0.9,\n        height: state.height * 0.8\n      })(this);\n    });\n    slot.select('title').text(function (d) {\n      return \"\".concat(d, \" \").concat(state.label);\n    });\n  }\n});\nvar legend = Kapsule({\n  props: {\n    width: {},\n    height: {},\n    scale: {},\n    label: {}\n  },\n  init: function init(el, state) {\n    state.legend = select(el).append('g').attr('class', 'legend');\n  },\n  update: function update(state) {\n    if (!state.scale) return; // Check if ordinal or continuous scale\n\n    var isOrdinal = !state.scale.hasOwnProperty('interpolate') && !state.scale.hasOwnProperty('interpolator'); // Only continuous scales can be interpolated\n\n    state.legend.html(''); // Wipe it\n\n    (isOrdinal ? DiscreteLegend : ContinuousLegend)().width(state.width).height(state.height).scale(state.scale).label(state.label)(state.legend.node());\n  }\n});\nexport default legend;","map":{"version":3,"sources":["D:/dataviz/d3-pie-chart/expense-tracker/node_modules/d3-color-legend/dist/d3-color-legend.module.js"],"names":["select","Kapsule","tinycolor","fitToBox","gradient","ContinuousLegend","props","width","height","scale","label","init","el","state","box","append","attr","unitLabel","style","labelFitText","node","startLabel","startLabelFitText","endLabel","endLabelFitText","update","colorScale","concat","id","text","domain","length","isLight","bbox","DiscreteLegend","colorBinWidth","slot","selectAll","data","exit","remove","newSlot","enter","merge","d","i","each","legend","isOrdinal","hasOwnProperty","html"],"mappings":"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","sourcesContent":["import { select } from 'd3-selection';\nimport Kapsule from 'kapsule';\nimport tinycolor from 'tinycolor2';\nimport { fitToBox } from 'svg-text-fit';\nimport { gradient } from 'svg-utils';\n\nvar ContinuousLegend = Kapsule({\n  props: {\n    width: {},\n    height: {},\n    scale: {},\n    label: {}\n  },\n  init: function init(el, state) {\n    state.gradient = gradient()(el);\n    state.el = select(el); // Build dom\n\n    state.box = state.el.append('rect').attr('x', 0).attr('y', 0).attr('rx', 3).attr('ry', 3).attr('stroke', 'black').attr('stroke-width', 0.5);\n    state.unitLabel = state.el.append('text').attr('class', 'legendText').style('text-anchor', 'middle').style('dominant-baseline', 'central');\n    state.labelFitText = fitToBox()(state.unitLabel.node());\n    state.startLabel = state.el.append('text').style('text-anchor', 'start').style('dominant-baseline', 'central');\n    state.startLabelFitText = fitToBox()(state.startLabel.node());\n    state.endLabel = state.el.append('text').style('text-anchor', 'end').style('dominant-baseline', 'central');\n    state.endLabelFitText = fitToBox()(state.endLabel.node());\n  },\n  update: function update(state) {\n    state.gradient.colorScale(state.scale);\n    state.box.attr('width', state.width).attr('height', state.height).style('fill', \"url(#\".concat(state.gradient.id(), \")\"));\n    state.unitLabel.text(state.label).attr('x', state.width * 0.5).attr('y', state.height * 0.5).style('text-anchor', 'middle').style('dominant-baseline', 'central').style('fill', tinycolor(state.scale((state.scale.domain()[state.scale.domain().length - 1] - state.scale.domain()[0]) / 2)).isLight() ? '#444' : '#CCC');\n    state.labelFitText.bbox({\n      width: state.width * 0.8,\n      height: state.height * 0.9\n    });\n    state.startLabel.text(state.scale.domain()[0]).attr('x', state.width * 0.02).attr('y', state.height * 0.5).style('fill', tinycolor(state.scale(state.scale.domain()[0])).isLight() ? '#444' : '#CCC');\n    state.startLabelFitText.bbox({\n      width: state.width * 0.3,\n      height: state.height * 0.7\n    });\n    state.endLabel.text(state.scale.domain()[state.scale.domain().length - 1]).attr('x', state.width * 0.98).attr('y', state.height * 0.5).style('fill', tinycolor(state.scale(state.scale.domain()[state.scale.domain().length - 1])).isLight() ? '#444' : '#CCC');\n    state.endLabelFitText.bbox({\n      width: state.width * 0.3,\n      height: state.height * 0.7\n    });\n  }\n});\n\nvar DiscreteLegend = Kapsule({\n  props: {\n    width: {},\n    height: {},\n    scale: {},\n    label: {}\n  },\n  init: function init(el, state) {\n    state.el = select(el);\n  },\n  update: function update(state) {\n    var colorBinWidth = state.width / state.scale.domain().length;\n    var slot = state.el.selectAll('.color-slot').data(state.scale.domain());\n    slot.exit().remove();\n    var newSlot = slot.enter().append('g').attr('class', 'color-slot');\n    newSlot.append('rect').attr('y', 0).attr('rx', 0).attr('ry', 0).attr('stroke-width', 0);\n    newSlot.append('text').style('text-anchor', 'middle').style('dominant-baseline', 'central');\n    newSlot.append('title'); // Update\n\n    slot = slot.merge(newSlot);\n    slot.select('rect').attr('width', colorBinWidth).attr('height', state.height).attr('x', function (d, i) {\n      return colorBinWidth * i;\n    }).attr('fill', function (d) {\n      return state.scale(d);\n    });\n    slot.select('text').text(function (d) {\n      return d;\n    }).attr('x', function (d, i) {\n      return colorBinWidth * (i + .5);\n    }).attr('y', state.height * 0.5).style('fill', function (d) {\n      return tinycolor(state.scale(d)).isLight() ? '#333' : '#DDD';\n    }).each(function (d) {\n      fitToBox().bbox({\n        width: colorBinWidth * 0.9,\n        height: state.height * 0.8\n      })(this);\n    });\n    slot.select('title').text(function (d) {\n      return \"\".concat(d, \" \").concat(state.label);\n    });\n  }\n});\n\nvar legend = Kapsule({\n  props: {\n    width: {},\n    height: {},\n    scale: {},\n    label: {}\n  },\n  init: function init(el, state) {\n    state.legend = select(el).append('g').attr('class', 'legend');\n  },\n  update: function update(state) {\n    if (!state.scale) return; // Check if ordinal or continuous scale\n\n    var isOrdinal = !state.scale.hasOwnProperty('interpolate') && !state.scale.hasOwnProperty('interpolator'); // Only continuous scales can be interpolated\n\n    state.legend.html(''); // Wipe it\n\n    (isOrdinal ? DiscreteLegend : ContinuousLegend)().width(state.width).height(state.height).scale(state.scale).label(state.label)(state.legend.node());\n  }\n});\n\nexport default legend;\n"]},"metadata":{},"sourceType":"module"}